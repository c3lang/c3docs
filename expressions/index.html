<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Expressions - C3 Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Expressions";
    var mkdocs_page_input_path = "expressions.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ebnf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bnf.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> C3 Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">About C3</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Installing</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../setup/">Setup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../firstproject/">Your first project</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../primer/">A quick primer on C3</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../allfeatures/">Feature list</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Documentation</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../changesfromc/">Changes from C</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../compare/">Comparisons with other languages</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../modules/">Modules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../types/">Types</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../define/">Define</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../arrays/">Arrays</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../functions/">Functions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../statements/">Statements</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Expressions</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#well-defined-evaluation-order">Well-defined evaluation order</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compound-literals">Compound literals</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#constant-expressions">Constant expressions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#including-binary-data">Including binary data</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#limiting-length">Limiting length</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#failure-to-load-at-compile-time-and-defaults">Failure to load at compile time and defaults</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../variables/">Variables</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../optionals/">Optionals and error handling</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../compiletime/">Compile time evaluation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../contracts/">Contracts</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../generics/">Generics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../macros/">Macros</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../reflection/">Reflection</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../operators/">Operator overloading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../anyinterfaces/">Any and protocols</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../undefinedbehaviour/">Undefined behaviour</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../conversion/">Conversions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../precedence/">Precedence</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../builtins/">Builtins</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../libraries/">Libraries</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../standard_library/">Standard Library</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ideas/">More ideas</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../naming/">Naming rules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../comments/">Comments & Docs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../attributes/">Attributes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../asm/">Inline asm</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cinterop/">C Interop</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../syntax/">Grammar</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sample/">More code examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../specification/">Specification</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Build system</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../buildintro/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../project/">Project Structure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../buildcommands/">Commands</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Development</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../contribute/">Contribute</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../changes/">Changes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../rejectedideas/">Rejected ideas</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">C3 Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation &raquo;</li>
        
      
    
    <li>Expressions</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="expressions">Expressions</h1>
<p>Expressions work like in C, with one exception: it is possible to take the address of a temporary. This uses the operator <code>&amp;&amp;</code> rather than <code>&amp;</code>.</p>
<p>Consequently, this is valid:</p>
<pre><code>fn void test(int* x) { ... }

test(&amp;&amp;1);

// In C:
// int x = 1;
// test(&amp;x);
</code></pre>
<h2 id="well-defined-evaluation-order">Well-defined evaluation order</h2>
<p>Expressions have a well-defined evaluation order:</p>
<ol>
<li>Binary expressions are evaluated from left to right.</li>
<li>Assignment occurs right to left, so <code>a = a++</code> would result in <code>a</code> being unchanged.</li>
<li>Call arguments are evaluated in parameter order.</li>
<li>For named parameters, evaluation is in parameter order, not argument order. So the evaluation order of 
<code>foo(.a = x++, .b = x--)</code> depends on the declaration order of <code>a</code> and <code>b</code>.</li>
</ol>
<h2 id="compound-literals">Compound literals</h2>
<p>C3 has C's compound literals, but unlike C's cast style syntax <code>(MyStruct) { 1, 2 }</code>, 
it uses C++ syntax: <code>MyStruct { 1, 2 }</code>.</p>
<pre><code>struct Foo
{
    int a;
    double b;
}

fn void test1(Foo x) { ... }

...

test1(Foo { 1, 2.0 });
</code></pre>
<p>Arrays follow the same syntax:</p>
<pre><code>fn void test2(int[3] x) { ... }

...

test2(int[3] { 1, 2, 3 });
</code></pre>
<p>Note that when it's possible, inferring the type is allowed, so we have for the above examples:</p>
<pre><code>test1({ 1, 2.0 });
test2({ 1, 2, 3 });
</code></pre>
<p>One may take the address of temporaries, using <code>&amp;&amp;</code> (rather than <code>&amp;</code> for normal variables). This allows the following:</p>
<p>Passing a slice</p>
<pre><code>fn void test(int[] y) { ... }

// Using &amp;&amp;
test(&amp;&amp;int[3]{ 1, 2, 3 });

// Explicitly slicing:
test(int[3]{ 1, 2, 3 }[..]));

// Using a slice directly as a temporary:
test(int[]{ 1, 2, 3 }));
</code></pre>
<p>Passing the pointer to an array</p>
<pre><code>fn void test1(int[3]* z) { ... }
fn void test2(int* z) { ... }

test1(&amp;&amp;int[3]{ 1, 2, 3 }));
test2(&amp;&amp;int[3]{ 1, 2, 3 }));
</code></pre>
<h2 id="constant-expressions">Constant expressions</h2>
<p>In C3 all <em>constant expressions</em> are guaranteed to be calculated at compile time. The following are considered constant expressions:</p>
<ol>
<li>The <code>null</code> literal.</li>
<li>Boolean, floating point and integer literals.</li>
<li>The result of arithmetics on constant expressions.</li>
<li>Compile time variables (prefixed with <code>$</code>)</li>
<li>Global constant variables with initializers that are constant expressions.</li>
<li>The result of macros that does not generate code and only uses constant expressions.</li>
<li>The result of a cast if the value is cast to a boolean, floating point or integer type and the value that is converted is a constant expression.</li>
<li>String literals.</li>
<li>Initializer lists containing constant values.</li>
</ol>
<p>Some things that are <em>not</em> constant expressions:</p>
<ol>
<li>Any pointer that isn't the <code>null</code> literal, even if it's derived from a constant expression.</li>
<li>The result of a cast except for casts of constant expressions to a numeric type.</li>
<li>Compound literals - even when values are constant expressions.</li>
</ol>
<h2 id="including-binary-data">Including binary data</h2>
<p>The <code>$embed(...)</code> function includes the contents of a file into the compilation as a
constant array of bytes:</p>
<pre><code>char[*] my_image = $embed("my_image.png");
</code></pre>
<p>The result of an embed work similar to a string literal and can implicitly convert to a <code>char*</code>, 
<code>void*</code>, <code>char[]</code>, <code>char[*]</code> and <code>String</code>.</p>
<h5 id="limiting-length">Limiting length</h5>
<p>It's possible to limit the length of included with the optional second parameter.</p>
<pre><code>char[4] my_data = $embed("foo.txt", 4];
</code></pre>
<h5 id="failure-to-load-at-compile-time-and-defaults">Failure to load at compile time and defaults</h5>
<p>Usually it's a compile time error if the file can't be included, but sometimes it's useful
to only optionally include it. If this is desired, declare the left hand side to be an optional:</p>
<pre><code>char[]! my_image = $embed("my_image.png");
</code></pre>
<p><code>my_image</code> with be an optional <code>IoError.FILE_NOT_FOUND?</code> if the image is missing.</p>
<p>This also allows us to pass a default value using <code>??</code>:</p>
<pre><code>char[] my_image = $embed("my_image.png") ?? DEFAULT_IMAGE_DATA;
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../variables/" class="btn btn-neutral float-right" title="Variables">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../statements/" class="btn btn-neutral" title="Statements"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../statements/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../variables/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
